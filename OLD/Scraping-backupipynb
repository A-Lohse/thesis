{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "honest-nickname",
   "metadata": {},
   "source": [
    "# Importing required packages"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "educated-tennis",
   "metadata": {},
   "outputs": [],
   "source": [
    "#imports\n",
    "from selenium import webdriver\n",
    "from bs4 import BeautifulSoup as bs\n",
    "import time\n",
    "import re\n",
    "import requests\n",
    "from urllib.request import urlopen\n",
    "import json\n",
    "from pandas.io.json import json_normalize\n",
    "import pandas as pd, numpy as np\n",
    "import random \n",
    "import os\n",
    "from selenium.webdriver.common.action_chains import ActionChains\n",
    "from selenium.webdriver.common.keys import Keys \n",
    "import pyautogui\n",
    "import urllib\n",
    "from PIL import Image\n",
    "from io import BytesIO\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "individual-cycling",
   "metadata": {},
   "source": [
    "# Defining functions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "occupational-pocket",
   "metadata": {},
   "outputs": [],
   "source": [
    "def wait():\n",
    "    rand = random.randrange(2000000) / 800000\n",
    "    time.sleep(rand)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "sealed-samuel",
   "metadata": {},
   "outputs": [],
   "source": [
    "def printProgressBar (iteration, total, prefix = '', suffix = '', decimals = 1, length = 100, fill = '█', printEnd = \"\\r\"):\n",
    "    \"\"\"\n",
    "    This function was develop by user: Greenstick (https://stackoverflow.com/users/2206251/greenstick)\n",
    "    on https://stackoverflow.com/questions/3173320/text-progress-bar-in-the-console\n",
    "    \n",
    "    Call in a loop to create terminal progress bar\n",
    "    @params:\n",
    "        iteration   - Required  : current iteration (Int)\n",
    "        total       - Required  : total iterations (Int)\n",
    "        prefix      - Optional  : prefix string (Str)\n",
    "        suffix      - Optional  : suffix string (Str)\n",
    "        decimals    - Optional  : positive number of decimals in percent complete (Int)\n",
    "        length      - Optional  : character length of bar (Int)\n",
    "        fill        - Optional  : bar fill character (Str)\n",
    "        printEnd    - Optional  : end character (e.g. \"\\r\", \"\\r\\n\") (Str)\n",
    "    \"\"\"\n",
    "    percent = (\"{0:.\" + str(decimals) + \"f}\").format(100 * (iteration / float(total)))\n",
    "    filledLength = int(length * iteration // total)\n",
    "    bar = fill * filledLength + '-' * (length - filledLength)\n",
    "    print(f'\\r{prefix} |{bar}| {percent}% {suffix}', end = printEnd)\n",
    "    # Print New Line on Complete\n",
    "    if iteration == total: \n",
    "        print()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "addressed-health",
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_info(browser,reactive = True):\n",
    "    \n",
    "    #browser.execute_script(\"window.open('');\")\n",
    "    #browser.switch_to.window(browser.window_handles[1])\n",
    "    #browser.get(link)\n",
    "    if reactive:\n",
    "    \n",
    "        try:      \n",
    "            date = browser.find_element_by_xpath(\"/html/body/div[4]/div[2]/div/article/div[3]/div[2]/a/time\").text\n",
    "        except:\n",
    "            date = np.nan\n",
    "        try:\n",
    "            text = browser.find_element_by_xpath(\"/html/body/div[4]/div[2]/div/article/div[3]/div[1]/ul/div/li/div/div/div[2]/span\").text\n",
    "\n",
    "        except:\n",
    "            text = np.nan\n",
    "\n",
    "        #try:\n",
    "         #   politician = browser.find_element_by_xpath('/html/body/div[4]/div[2]/div/article/header/div[2]/div[1]/div[1]/span/a').text\n",
    "        #except:\n",
    "         #   politician = np.nan\n",
    "        #try:\n",
    "         #   verified = browser.find_element_by_xpath('/html/body/div[4]/div[2]/div/article/header/div[2]/div[1]/div[1]/div/span').text\n",
    "        #except:\n",
    "         #   verified = np.nan\n",
    "\n",
    "        try:\n",
    "            likes = browser.find_element_by_xpath('/html/body/div[4]/div[2]/div/article/div[3]/section[2]/div/div/a').text\n",
    "        except:\n",
    "            likes = np.nan\n",
    "\n",
    "        #try:\n",
    "         #   location = browser.find_element_by_xpath('/html/body/div[4]/div[2]/div/article/header/div[2]/div[2]/div[2]/a').text\n",
    "       # except:\n",
    "        #    location = np.nan\n",
    "\n",
    "        #browser.close()\n",
    "        #browser.switch_to.window(browser.window_handles[0])\n",
    "    else:\n",
    "        try:      \n",
    "            date = browser.find_element_by_xpath('//*[@id=\"react-root\"]/section/main/div/div[1]/article/div[3]/div[2]/a/time').text\n",
    "        except:\n",
    "            date = np.nan\n",
    "        try:\n",
    "            text = browser.find_element_by_xpath('//*[@id=\"react-root\"]/section/main/div/div[1]/article/div[3]/div[1]/ul/div/li/div/div/div[2]/span').text\n",
    "\n",
    "        except:\n",
    "            text = np.nan\n",
    "        \n",
    "        try:\n",
    "            likes = browser.find_element_by_xpath('//*[@id=\"react-root\"]/section/main/div/div[1]/article/div[3]/section[2]/div/div/a').text\n",
    "        except:\n",
    "            likes = np.nan\n",
    "\n",
    "\n",
    "    return date,text,likes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "banner-technical",
   "metadata": {},
   "outputs": [],
   "source": [
    "def scroll(browser, timeout, **kwargs):\n",
    "    scroll_pause_time = timeout\n",
    "    \n",
    "    folder = \"C:\\\\Users\\\\augus\\\\OneDrive - Københavns Universitet\\\\Documents\\\\Uni\\\\Kandidat i Statskundskab\\\\Speciale\\\\kode\\\\Posts\\\\\"+ user +\"\\\\\"\n",
    "    pslink_name = folder + user + \"_postlinks.txt\"\n",
    "    piclink_name =  folder + user + \"_piclinks.txt\"\n",
    "    \n",
    "    if os.path.isfile(pslink_name) and os.path.isfile(piclink_name):\n",
    "        with open(pslink_name, 'r') as file:\n",
    "            post_links = file.read.splitlines()\n",
    "        with open(piclink_name, 'r') as file:\n",
    "            pic_links = file.read.splitlines()\n",
    "        #pic_links = [post[:-1] for post in pic_links]\n",
    "        #post_links = [post[:-1] for post in post_links]\n",
    "        \n",
    "        return post_links, pic_links\n",
    "        \n",
    "    else:\n",
    "    \n",
    "        post_links = []\n",
    "        pic_links = []\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "        # Get scroll height\n",
    "        last_height = browser.execute_script(\"return document.body.scrollHeight\")\n",
    "\n",
    "        while True:\n",
    "            # Scroll down to bottom\n",
    "            browser.execute_script(\"window.scrollTo(0, document.body.scrollHeight);\")\n",
    "\n",
    "            # Wait to load page\n",
    "            time.sleep(scroll_pause_time)\n",
    "\n",
    "            #get post links \n",
    "            try:\n",
    "                post_element = browser.find_element_by_xpath('//*[@id=\"react-root\"]/section/main/div/div[3]/article/div[1]/div')\n",
    "            except:\n",
    "                time.sleep(2)\n",
    "                try:\n",
    "                    post_element = browser.find_element_by_xpath('//*[@id=\"react-root\"]/section/main/div/div[3]/article/div[1]/div')\n",
    "                except:\n",
    "                    post_element = browser.find_element_by_tag_name(\"article\")\n",
    "            links = post_element.find_elements_by_tag_name('a')\n",
    "\n",
    "            for i, n in enumerate(links):\n",
    "                href = links[i].get_attribute('href')\n",
    "\n",
    "                if href not in post_links:\n",
    "                    post_links.append(href)\n",
    "\n",
    "            #get picture links\n",
    "            pic_elements = browser.find_elements_by_class_name('KL4Bh')\n",
    "\n",
    "            for i, n in enumerate(pic_elements):\n",
    "                href = pic_elements[i].find_element_by_tag_name(\"img\").get_attribute(\"src\")\n",
    "\n",
    "                if href not in pic_links:\n",
    "                    pic_links.append(href)\n",
    "\n",
    "            new_height = browser.execute_script(\"return document.body.scrollHeight\")\n",
    "            if new_height == last_height:\n",
    "                # If heights are the same it will exit the function\n",
    "                break\n",
    "            last_height = new_height\n",
    "\n",
    "            #if the scroll has not ended - test if the last link is before 6 month before August 26th of 2020\n",
    "            # that means if the post is before Februrary 26th i stop the scroll \n",
    "            #open new tab\n",
    "            browser.execute_script(\"window.open('');\")\n",
    "            browser.switch_to.window(browser.window_handles[1])\n",
    "            browser.get(post_links[-1])\n",
    "\n",
    "            soup = bs(browser.page_source)\n",
    "\n",
    "            try:\n",
    "                date = soup.time['datetime']\n",
    "\n",
    "                b = cutoff_day(date)\n",
    "\n",
    "            except:\n",
    "                date = np.nan\n",
    "\n",
    "            #close the tab\n",
    "            browser.close()\n",
    "            #switch back to scrolling tab\n",
    "            browser.switch_to.window(browser.window_handles[0])\n",
    "            #test if we are past cutoff day\n",
    "            if b:\n",
    "                break\n",
    "        return post_links, pic_links"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "rotary-drunk",
   "metadata": {},
   "outputs": [],
   "source": [
    "def cutoff_day(date):    \n",
    "    year = int(date[0:4])\n",
    "    month = int(date[5:7])\n",
    "    day = int(date[8:10])\n",
    "    \n",
    "    if year < 2020:\n",
    "        b = True\n",
    "    elif year == 2020 and month < 2:\n",
    "        b = True\n",
    "    elif year == 2020 and month == 2 and day < 26:\n",
    "        b = True\n",
    "    else: \n",
    "        b = False\n",
    "    return b"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "forbidden-labor",
   "metadata": {},
   "outputs": [],
   "source": [
    "def use_links(post_links,pic_links, **kwargs):\n",
    "    ##################### use the links ###################################\n",
    "    folder = \"C:\\\\Users\\\\augus\\\\OneDrive - Københavns Universitet\\\\Documents\\\\Uni\\\\Kandidat i Statskundskab\\\\Speciale\\\\kode\\\\Posts\\\\\"+ user +\"\\\\\"\n",
    "    #print(\"Saving images to:\",folder)\n",
    "    #print(\"The user is:\",user)\n",
    "    \n",
    "    #posts = pd.DataFrame(columns= [\"post_nr\",\"date\",\"text\",\"politician\",\"verified\",\"likes\",\"location\"])\n",
    "    \n",
    "    if not os.path.isdir(folder):\n",
    "        os.makedirs(folder)\n",
    "        #get information on the posts\n",
    "    \n",
    "    #request pictures   \n",
    "    l = len(pic_links)\n",
    "    print(\"Gathering pictures\")\n",
    "    printProgressBar(0, l, prefix = 'Progress:', suffix = 'Complete', length = 50)\n",
    "\n",
    "    for i, n in enumerate(pic_links):\n",
    "\n",
    "        number = random.randrange(70)\n",
    "        if number == 1:                                  \n",
    "            #print(\"taking a random brake\")\n",
    "            time.sleep(60)\n",
    "        name = folder + \"pic_\" + str(i) + \".jpeg\"\n",
    "        if not os.path.isfile(name):\n",
    "            try:\n",
    "                image = Image.open(BytesIO(requests.get(pic_links[i]).content))                \n",
    "                image.save(name)\n",
    "                #urllib.request.urlretrieve(pic_links[i],name)\n",
    "            except: \n",
    "                image = Image.open('C:\\\\Users\\\\augus\\\\OneDrive - Københavns Universitet\\\\Documents\\\\Uni\\\\Kandidat i Statskundskab\\\\Speciale\\\\kode\\\\backup.jpg')\n",
    "                image.save(name)\n",
    "                image.close()\n",
    "        time.sleep(2)\n",
    "        printProgressBar(i + 1, l, prefix = 'Progress:', suffix = 'Complete', length = 50)\n",
    "\n",
    "    \n",
    "    #####browser = start_new_browser()\n",
    "    #l = len(post_links)\n",
    "    #print(\"Gathering information\")\n",
    "    #printProgressBar(0, l, prefix = 'Progress:', suffix = 'Complete', length = 50)\n",
    "    #for i, n in enumerate(post_links):\n",
    "        \n",
    "        #breaks\n",
    "     #   number = random.randrange(70)\n",
    "      #  if number == 1:\n",
    "            \n",
    "            #print(\"taking a random brake\")\n",
    "            #browser.close()\n",
    "            #browser = start_new_browser()\n",
    "       #     time.sleep(60)\n",
    "            \n",
    "\n",
    "        #get data\n",
    "        #date, text, politician, verified, likes, location = get_info(browser,post_links[i])\n",
    "            \n",
    "       # posts.loc[len(posts)] = [str(i),date,text,politician,verified,likes,location]\n",
    "       # printProgressBar(i + 1, l, prefix = 'Progress:', suffix = 'Complete', length = 50)\n",
    "\n",
    "        #wait()   \n",
    "\n",
    "        \n",
    "    #posts[\"posts_link\"] = post_links\n",
    "    #posts[\"pic_link\"] = pic_links\n",
    "    \n",
    "    #filename = folder + user +\".csv\"\n",
    "    #posts.to_csv(filename)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "limited-absolute",
   "metadata": {},
   "outputs": [],
   "source": [
    "def all_links(user):\n",
    "    url = 'https://www.instagram.com/'+user+'/?hl=en'\n",
    "    # driver.get(url) opens the page\n",
    "    browser.get(url)\n",
    "    # This starts the scrolling by passing the driver and a timeout\n",
    "    post_links, pic_links = scroll(browser, 5)\n",
    "    print(\"finished getting links\")\n",
    "    \n",
    "    # Once scroll returns bs4 parsers the page_source\n",
    "    #all_soup = bs(browser.page_source, 'html.parser')\n",
    "    # Them we close the driver as soup_a is storing the page source\n",
    "    #browser.close()\n",
    "    \n",
    "    #get the data\n",
    "  \n",
    "    return post_links, pic_links"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "skilled-liquid",
   "metadata": {},
   "outputs": [],
   "source": [
    "def start_new_browser():\n",
    "    browser = webdriver.Chrome('chromedriver')\n",
    "    browser.get('https://www.instagram.com/?hl=en')\n",
    "    browser.implicitly_wait(3)\n",
    "    browser.find_element_by_xpath(\"/html/body/div[2]/div/div/div/div[2]/button[1]\").click()\n",
    "    \n",
    "    username = \"kaarevisted\"#\"borgerjensen\"#\"gertjensen123\" \n",
    "    password =  \"Håberdetvirker!!\"#\"Håberdetvirker!\"#\"Turpas123!\" \n",
    "    \n",
    "    browser.find_element_by_xpath('//*[@id=\"loginForm\"]/div/div[1]/div/label/input').send_keys(username)\n",
    "    wait()\n",
    "    browser.find_element_by_xpath('//*[@id=\"loginForm\"]/div/div[2]/div/label/input').send_keys(password)\n",
    "    wait()\n",
    "    browser.find_element_by_xpath('//*[@id=\"loginForm\"]/div/div[3]/button/div').click()\n",
    "    browser.implicitly_wait(5)\n",
    "    \n",
    "    wait()\n",
    "    try:\n",
    "        browser.find_element_by_xpath('//*[@id=\"react-root\"]/section/main/div/div/div/div/button').click()\n",
    "    except: \n",
    "        pass\n",
    "    wait()\n",
    "    try:\n",
    "        browser.find_element_by_xpath('/html/body/div[4]/div/div/div/div[3]/button[2]').click()\n",
    "    except:\n",
    "        browser.find_element_by_class_name(\"aOOlW   HoLwm\").click()\n",
    "\n",
    "    return browser"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "olympic-weight",
   "metadata": {},
   "outputs": [],
   "source": [
    "def click_next_and_save(user, post_link_start, amount_of_posts):\n",
    "    ''' user is the user to be scraped \n",
    "        post link start is the link to the post to start by \n",
    "        amount of posts is the amount of posts that we want, including the starting post.\n",
    "        \n",
    "        the function needs an active browser \n",
    "    '''\n",
    "    url = 'https://www.instagram.com/'+user+'/?hl=en'\n",
    "    browser.get(url)\n",
    "    browser.implicitly_wait(2)\n",
    "    \n",
    "    #find all the links of the first page:\n",
    "    posts = browser.find_elements_by_class_name(\"v1Nh3\")\n",
    "    for i, p in enumerate(posts):\n",
    "        link = posts[i].find_elements_by_tag_name('a')\n",
    "        if link[0].get_attribute('href') == post_link_start:\n",
    "            #print(\"starting at link\", i+1)\n",
    "            break\n",
    "        elif i == len(posts):\n",
    "            i = 0\n",
    "            print(\"Could not find start link on first page. Starting on first post\")\n",
    "    \n",
    "    #make a folder to save the html to \n",
    "    folder = \"C:\\\\Users\\\\augus\\\\OneDrive - Københavns Universitet\\\\Documents\\\\Uni\\\\Kandidat i Statskundskab\\\\Speciale\\\\kode\\\\Posts\\\\\"+ user +\"\\\\html\\\\\"\n",
    "    if not os.path.isdir(folder):\n",
    "        os.makedirs(folder)\n",
    "\n",
    "    #make a while loop \n",
    "    posts = pd.DataFrame(columns= [\"post_nr\",\"date\",\"text\",\"likes\"])\n",
    "\n",
    "    n = 0\n",
    "    \n",
    "    printProgressBar(0, amount_of_posts, prefix = 'Progress:', suffix = 'Complete', length = 50)\n",
    "\n",
    "    while n < amount_of_posts:\n",
    "        if n == 0:\n",
    "            #i is the number of the first post found earlier n is the ittertaion in this loop\n",
    "            browser.find_elements_by_class_name(\"_9AhH0\")[i].click()    \n",
    "            filename = folder +\"pic_\" + str(n) +\".html\"\n",
    "            browser.implicitly_wait(2)\n",
    "            html_file= open(filename,\"w\",encoding='utf-8')\n",
    "            html_file.write(str(browser.page_source))\n",
    "            html_file.close()\n",
    "            \n",
    "            #get info\n",
    "            date,text,likes = get_info(browser)\n",
    "            \n",
    "            posts.loc[n] = [str(n),date,text,likes]\n",
    "\n",
    "\n",
    "        else:\n",
    "            browser.find_element_by_class_name('_65Bje').click()\n",
    "            filename = folder + \"pic_\" + str(n) +\".html\"\n",
    "            html_file= open(filename,\"w\",encoding='utf-8')\n",
    "            browser.implicitly_wait(2)\n",
    "            html_file.write(str(browser.page_source))\n",
    "            html_file.close()\n",
    "            \n",
    "            #random break\n",
    "            number = random.randrange(30)\n",
    "            if number == 1:                                  \n",
    "            #print(\"taking a random brake\")\n",
    "                time.sleep(60)\n",
    "            \n",
    "            date,text,likes = get_info(browser)\n",
    "            \n",
    "            posts.loc[n] = [str(n),date,text,likes]\n",
    "                \n",
    "    #take a break\n",
    "\n",
    "        printProgressBar(n + 1, amount_of_posts, prefix = 'Progress:', suffix = 'Complete', length = 50)\n",
    "    #update the while loop by looking at the len of the list of link (eg i == len - 1 (because of 0 indexing))\n",
    "        n += 1\n",
    "        time.sleep(2)\n",
    "    \n",
    "    \n",
    "    filename = \"C:\\\\Users\\\\augus\\\\OneDrive - Københavns Universitet\\\\Documents\\\\Uni\\\\Kandidat i Statskundskab\\\\Speciale\\\\kode\\\\Posts\\\\\" + user +\"\\\\\"+user + \".csv\"\n",
    "    posts.to_csv(filename)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "upper-disclaimer",
   "metadata": {},
   "source": [
    "# Scraping"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "exclusive-miller",
   "metadata": {},
   "source": [
    "Jeg begynder nu scraping. Der foregår i et par tring:\n",
    "\n",
    "    - Jeg åbner en start instagram browser. Hvis login skal ændres er det i start_new_browser functionen\n",
    "    - Jeg definere de brugere jeg vil scrabe\n",
    "    - herefter sætter jeg scraberen igang. \n",
    "    - Det tager ca. 0.3 minut (20 sek) at hente 1 post med alt infomation og billede \n",
    "    - Forvent derfor alt i mellem 10 min og 90 min for en bruger alt afhængig af antal billeder. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "institutional-house",
   "metadata": {},
   "outputs": [],
   "source": [
    "browser = start_new_browser()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "about-freeware",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "with open(\"brugere.txt\",'r') as file:\n",
    "    users = file.read().splitlines()\n",
    "    #users = [post[:-1] for post in users]\n",
    "len(users)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "formed-alliance",
   "metadata": {},
   "outputs": [],
   "source": [
    "howmany = 0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "treated-tattoo",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Working on jakobellemann\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: jakobellemann\n",
      "Total runtime of the program is for user jakobellemann is 9.162133884429931 min\n"
     ]
    }
   ],
   "source": [
    "#set to true to use links instead of click\n",
    "warning = False\n",
    "for user in users:\n",
    "    if howmany >= 35:\n",
    "        break\n",
    "    \n",
    "    if warning: \n",
    "        begin = time.time()\n",
    "\n",
    "        print(\"Working on\", user)\n",
    "\n",
    "        with open(\"posts\\\\\" + user +\"\\\\\" + user +\"_postlinks.txt\",'r') as file:\n",
    "            links  = file.read().splitlines()\n",
    "\n",
    "        folder = \"C:\\\\Users\\\\augus\\\\OneDrive - Københavns Universitet\\\\Documents\\\\Uni\\\\Kandidat i Statskundskab\\\\Speciale\\\\kode\\\\Posts\\\\\"+ user +\"\\\\html\\\\\"\n",
    "        if not os.path.isdir(folder):\n",
    "            os.makedirs(folder)\n",
    "\n",
    "        #users = [post[:-1] for post in users]\n",
    "        #startlink = links[0]\n",
    "        #num = len(links)\n",
    "        posts = pd.DataFrame(columns= [\"post_nr\",\"date\",\"text\",\"likes\"])\n",
    "\n",
    "        printProgressBar(0, len(links), prefix = 'Progress:', suffix = 'Complete', length = 50)\n",
    "\n",
    "        for i_,link in enumerate(links):\n",
    "            browser.get(link)\n",
    "            browser.implicitly_wait(4)\n",
    "\n",
    "            #get the html\n",
    "\n",
    "            filename = folder + \"pic_\" + str(i_) +\".html\"\n",
    "            html_file= open(filename,\"w\",encoding='utf-8')\n",
    "            html_file.write(str(browser.page_source))\n",
    "            html_file.close()\n",
    "\n",
    "            #get the data\n",
    "\n",
    "            date,text,likes = get_info(browser,reactive = False)\n",
    "\n",
    "            posts.loc[i_] = [str(i_),date,text,likes]\n",
    "\n",
    "            printProgressBar(i_ +1, len(links), prefix = 'Progress:', suffix = 'Complete', length = 50)\n",
    "\n",
    "\n",
    "        filename = \"C:\\\\Users\\\\augus\\\\OneDrive - Københavns Universitet\\\\Documents\\\\Uni\\\\Kandidat i Statskundskab\\\\Speciale\\\\kode\\\\Posts\\\\\" + user +\"\\\\\"+user + \".csv\"\n",
    "        posts.to_csv(filename)\n",
    "\n",
    "        time.sleep(2)\n",
    "\n",
    "        end = time.time()\n",
    "        print(f\"Finished with user: {user}\")\n",
    "        print(f\"Total runtime of the program is for user {user} is {(end - begin) /60} min\") \n",
    "\n",
    "        browser.close()\n",
    "        time.sleep(130)\n",
    "\n",
    "        browser = start_new_browser()\n",
    "        browser.implicitly_wait(10)\n",
    "\n",
    "    else:\n",
    "\n",
    "        begin = time.time()\n",
    "\n",
    "        print(\"Working on\", user)\n",
    "\n",
    "        with open(\"posts\\\\\" + user +\"\\\\\" + user +\"_postlinks.txt\",'r') as file:\n",
    "            links  = file.read().splitlines()\n",
    "        #users = [post[:-1] for post in users]\n",
    "        startlink = links[0]\n",
    "        num = len(links)\n",
    "\n",
    "        #get the data\n",
    "        click_next_and_save(user,startlink,num)\n",
    "\n",
    "        end = time.time()\n",
    "        print(f\"Finished with user: {user}\")\n",
    "        print(f\"Total runtime of the program is for user {user} is {(end - begin) /60} min\") \n",
    "\n",
    "        browser.close()\n",
    "        time.sleep(130)\n",
    "        browser = start_new_browser()\n",
    "        browser.implicitly_wait(10)\n",
    "        \n",
    "    howmany += 1\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "narrative-disaster",
   "metadata": {},
   "source": [
    "# Hent billeder \n",
    "Er kørt - tager omkring 6 timer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "disabled-church",
   "metadata": {},
   "outputs": [],
   "source": [
    "with open(\"brugere.txt\",'r') as file:\n",
    "    users = file.read().splitlines() \n",
    "    #users = [post[:-1] for post in users]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "canadian-superintendent",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Working on j.h.thulesen.dahl\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: j.h.thulesen.dahl\n",
      "Total runtime of the program is for user j.h.thulesen.dahl is 0.5415247241655986 min\n",
      "Working on kristianthulesendahl\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: kristianthulesendahl\n",
      "Total runtime of the program is for user kristianthulesendahl is 4.5873776316642765 min\n",
      "Working on mettedencker\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: mettedencker\n",
      "Total runtime of the program is for user mettedencker is 9.35165504614512 min\n",
      "Working on dennisflydtkjaer1\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: dennisflydtkjaer1\n",
      "Total runtime of the program is for user dennisflydtkjaer1 is 1.7461209575335184 min\n",
      "Working on krarupmarie\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: krarupmarie\n",
      "Total runtime of the program is for user krarupmarie is 2.7487037897109987 min\n",
      "Working on mrmesserschmidt\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: mrmesserschmidt\n",
      "Total runtime of the program is for user mrmesserschmidt is 15.221812784671783 min\n",
      "Working on peter_skaarup\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: peter_skaarup\n",
      "Total runtime of the program is for user peter_skaarup is 5.030509893099467 min\n",
      "Working on tommyahlers\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: tommyahlers\n",
      "Total runtime of the program is for user tommyahlers is 2.2254624485969545 min\n",
      "Working on hansandersenmf\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: hansandersenmf\n",
      "Total runtime of the program is for user hansandersenmf is 8.461663556098937 min\n",
      "Working on brittbager\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: brittbager\n",
      "Total runtime of the program is for user brittbager is 1.5512959400812785 min\n",
      "Working on heidibank\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: heidibank\n",
      "Total runtime of the program is for user heidibank is 1.6938421130180359 min\n",
      "Working on mariebjerre.dk\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: mariebjerre.dk\n",
      "Total runtime of the program is for user mariebjerre.dk is 5.3355687419573465 min\n",
      "Working on bonnesenerling\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: bonnesenerling\n",
      "Total runtime of the program is for user bonnesenerling is 1.6724292119344075 min\n",
      "Working on mortendahlin\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: mortendahlin\n",
      "Total runtime of the program is for user mortendahlin is 3.513022991021474 min\n",
      "Working on louise_elholm\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: louise_elholm\n",
      "Total runtime of the program is for user louise_elholm is 4.077566583951314 min\n",
      "Working on karen.ellemann\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: karen.ellemann\n",
      "Total runtime of the program is for user karen.ellemann is 2.083849557240804 min\n",
      "Working on fugledemads\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: fugledemads\n",
      "Total runtime of the program is for user fugledemads is 3.2761641343434653 min\n",
      "Working on martinr.geertsen\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: martinr.geertsen\n",
      "Total runtime of the program is for user martinr.geertsen is 0.8987296104431153 min\n",
      "Working on evakjerhansen\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: evakjerhansen\n",
      "Total runtime of the program is for user evakjerhansen is 3.366493626435598 min\n",
      "Working on janeheitmann\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: janeheitmann\n",
      "Total runtime of the program is for user janeheitmann is 5.6024827321370445 min\n",
      "Working on jakobellemann\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: jakobellemann\n",
      "Total runtime of the program is for user jakobellemann is 8.280067006746927 min\n",
      "Working on bertel.haarder\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: bertel.haarder\n",
      "Total runtime of the program is for user bertel.haarder is 2.5034919102986652 min\n",
      "Working on jacobjensen_venstre\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: jacobjensen_venstre\n",
      "Total runtime of the program is for user jacobjensen_venstre is 1.213457743326823 min\n",
      "Working on kristianjensenmf\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: kristianjensenmf\n",
      "Total runtime of the program is for user kristianjensenmf is 3.844009641806285 min\n",
      "Working on michaelaastrupjensen\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: michaelaastrupjensen\n",
      "Total runtime of the program is for user michaelaastrupjensen is 3.216863199075063 min\n",
      "Working on jan_e_joergensen\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: jan_e_joergensen\n",
      "Total runtime of the program is for user jan_e_joergensen is 4.729035969575246 min\n",
      "Working on marcus.knuth\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: marcus.knuth\n",
      "Total runtime of the program is for user marcus.knuth is 3.0870989481608073 min\n",
      "Working on stenknuth\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: stenknuth\n",
      "Total runtime of the program is for user stenknuth is 16.966596666971842 min\n",
      "Working on karstenlauritzen\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: karstenlauritzen\n",
      "Total runtime of the program is for user karstenlauritzen is 4.856644344329834 min\n",
      "Working on lars_chr_lilleholt\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: lars_chr_lilleholt\n",
      "Total runtime of the program is for user lars_chr_lilleholt is 2.361471696694692 min\n",
      "Working on lorentzenkristian\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: lorentzenkristian\n",
      "Total runtime of the program is for user lorentzenkristian is 12.585737542311351 min\n",
      "Working on sophieloehde\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: sophieloehde\n",
      "Total runtime of the program is for user sophieloehde is 4.163084638118744 min\n",
      "Working on annimatthiesen\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: annimatthiesen\n",
      "Total runtime of the program is for user annimatthiesen is 6.958403257528941 min\n",
      "Working on christoffermelson\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: christoffermelson\n",
      "Total runtime of the program is for user christoffermelson is 5.470004212856293 min\n",
      "Working on ellentranenorby\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: ellentranenorby\n",
      "Total runtime of the program is for user ellentranenorby is 2.779403261343638 min\n",
      "Working on torstenschackpedersen\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: torstenschackpedersen\n",
      "Total runtime of the program is for user torstenschackpedersen is 4.512835566202799 min\n",
      "Working on traktortroels\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: traktortroels\n",
      "Total runtime of the program is for user traktortroels is 1.7547609090805054 min\n",
      "Working on marleneambo\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: marleneambo\n",
      "Total runtime of the program is for user marleneambo is 3.5122215867042543 min\n",
      "Working on stojberginger\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: stojberginger\n",
      "Total runtime of the program is for user stojberginger is 1.6206337213516235 min\n",
      "Working on ullatornaes\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: ullatornaes\n",
      "Total runtime of the program is for user ullatornaes is 8.412737993399302 min\n",
      "Working on ftmktm\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: ftmktm\n",
      "Total runtime of the program is for user ftmktm is 11.804571553071339 min\n",
      "Working on annehonoreoestergaard\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: annehonoreoestergaard\n",
      "Total runtime of the program is for user annehonoreoestergaard is 7.585542559623718 min\n",
      "Working on evaflyvholm_enhedslisten\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: evaflyvholm_enhedslisten\n",
      "Total runtime of the program is for user evaflyvholm_enhedslisten is 2.675196341673533 min\n",
      "Working on rosa_lund\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: rosa_lund\n",
      "Total runtime of the program is for user rosa_lund is 11.050112199783324 min\n",
      "Working on kommune_rune\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: kommune_rune\n",
      "Total runtime of the program is for user kommune_rune is 0.3939192295074463 min\n",
      "Working on pernille_skipper\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: pernille_skipper\n",
      "Total runtime of the program is for user pernille_skipper is 5.775965269406637 min\n",
      "Working on victoria.r.velasquez\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: victoria.r.velasquez\n",
      "Total runtime of the program is for user victoria.r.velasquez is 9.434865053494772 min\n",
      "Working on mai_villadsen\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: mai_villadsen\n",
      "Total runtime of the program is for user mai_villadsen is 4.575989874204 min\n",
      "Working on nikolajvillumsen\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: nikolajvillumsen\n",
      "Total runtime of the program is for user nikolajvillumsen is 10.032671662171682 min\n",
      "Working on elbaekuffe\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: elbaekuffe\n",
      "Total runtime of the program is for user elbaekuffe is 6.0331387400627134 min\n",
      "Working on torsten.gejl\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: torsten.gejl\n",
      "Total runtime of the program is for user torsten.gejl is 1.834658936659495 min\n",
      "Working on rnordqvist\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: rnordqvist\n",
      "Total runtime of the program is for user rnordqvist is 1.0778660376866658 min\n",
      "Working on sikandarsiddique_\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: sikandarsiddique_\n",
      "Total runtime of the program is for user sikandarsiddique_ is 9.018020677566529 min\n",
      "Working on susannezimmerfriegronne\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: susannezimmerfriegronne\n",
      "Total runtime of the program is for user susannezimmerfriegronne is 10.694390753904978 min\n",
      "Working on sjurdurskaale\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: sjurdurskaale\n",
      "Total runtime of the program is for user sjurdurskaale is 6.045558818181356 min\n",
      "Working on akimati\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: akimati\n",
      "Total runtime of the program is for user akimati is 1.6551764806111653 min\n",
      "Working on aaja_chemnitz\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: aaja_chemnitz\n",
      "Total runtime of the program is for user aaja_chemnitz is 1.1071253617604573 min\n",
      "Working on kirstennormann\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: kirstennormann\n",
      "Total runtime of the program is for user kirstennormann is 0.872909939289093 min\n",
      "Working on annevalentinaberthelsen\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: annevalentinaberthelsen\n",
      "Total runtime of the program is for user annevalentinaberthelsen is 2.5788008093833925 min\n",
      "Working on astridcaroe\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: astridcaroe\n",
      "Total runtime of the program is for user astridcaroe is 1.594714645544688 min\n",
      "Working on karina_lorentzen_dehnhardt\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: karina_lorentzen_dehnhardt\n",
      "Total runtime of the program is for user karina_lorentzen_dehnhardt is 8.776200910409292 min\n",
      "Working on khoenge\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: khoenge\n",
      "Total runtime of the program is for user khoenge is 10.405750898520152 min\n",
      "Working on jacobmarkfolketinget\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: jacobmarkfolketinget\n",
      "Total runtime of the program is for user jacobmarkfolketinget is 11.000337119897207 min\n",
      "Working on charlottemolbaek\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: charlottemolbaek\n",
      "Total runtime of the program is for user charlottemolbaek is 7.274217359224955 min\n",
      "Working on misshalimeoguz\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: misshalimeoguz\n",
      "Total runtime of the program is for user misshalimeoguz is 1.5207796653111776 min\n",
      "Working on lisbethbp\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: lisbethbp\n",
      "Total runtime of the program is for user lisbethbp is 7.53295750617981 min\n",
      "Working on torp71\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: torp71\n",
      "Total runtime of the program is for user torp71 is 3.995143973827362 min\n",
      "Working on carl_valentin\n",
      "Getting links\n",
      "finished getting links\n",
      "Fisnished saving the links, now moving onto getting the data\n",
      "Gathering pictures\n",
      "Progress: |██████████████████████████████████████████████████| 100.0% Complete\n",
      "Finished with user: carl_valentin\n",
      "Total runtime of the program is for user carl_valentin is 1.6779678225517274 min\n"
     ]
    }
   ],
   "source": [
    "for user in users:\n",
    "    begin = time.time()\n",
    "\n",
    "    print(\"Working on\", user)\n",
    "    print(\"Getting links\")\n",
    "    post_links, pic_links = all_links(user)\n",
    "    \n",
    "    folder = \"C:\\\\Users\\\\augus\\\\OneDrive - Københavns Universitet\\\\Documents\\\\Uni\\\\Kandidat i Statskundskab\\\\Speciale\\\\kode\\\\Posts\\\\\"+ user +\"\\\\\"\n",
    "    #check if folder exists, otherwise make it\n",
    "    if not os.path.isdir(folder):\n",
    "        os.makedirs(folder)\n",
    "    \n",
    "    filename = folder + user + \"_postlinks.txt\"\n",
    "    file = open(filename, 'w')\n",
    "    for element in post_links:\n",
    "        file.write(element)\n",
    "        file.write('\\n')\n",
    "\n",
    "    # closing the file\n",
    "    file.close()\n",
    "    \n",
    "    filename = folder + user + \"_piclinks.txt\"\n",
    "    file = open(filename, 'w')\n",
    "    for element in pic_links:\n",
    "        file.write(element)\n",
    "        file.write(\"\\n\")\n",
    "\n",
    "    # closing the file\n",
    "    file.close()\n",
    "    \n",
    "    print(\"Fisnished saving the links, now moving onto getting the data\")\n",
    "    \n",
    "    use_links(post_links,pic_links, user=user)\n",
    "    \n",
    "    end = time.time()\n",
    "    print(f\"Finished with user: {user}\")\n",
    "    print(f\"Total runtime of the program is for user {user} is {(end - begin) /60} min\") \n",
    "    \n",
    "    browser.close()\n",
    "    browser = start_new_browser()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "hairy-cooperation",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'carl_valentin'"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "local-haven",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "generous-retention",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "temporal-recall",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
